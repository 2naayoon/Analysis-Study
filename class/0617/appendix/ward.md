### 🧩 Ward 연결법 (Ward Linkage)

#### 🔍 개요

Ward 연결법은 계층적 군집에서 **두 군집을 합칠 때, 전체 군집 내 오차 제곱합(SSE: Sum of Squared Errors)이 가장 작아지는 방식**을 선택하는 방법입니다.

* 즉, **두 군집을 합쳤을 때 SSE가 최소로 증가하는 쌍**을 병합합니다.
* 이 방식은 단순한 거리 계산이 아닌 **군집 내 분산 최소화**에 초점을 맞추므로, K-Means와 유사한 군집 경향을 보입니다.

---

### 📐 수학적 설명

* 각 군집 $C_1, C_2$의 중심은 $\mu_1, \mu_2$
* 군집을 병합했을 때 새 군집의 중심은 $\mu_{new}$
* Ward는 **병합 전후의 SSE 차이(증가량)** 를 계산합니다:

$$
\text{Increase in SSE} = SSE_{new} - (SSE_{C_1} + SSE_{C_2})
$$

* 이 증가량이 **가장 작은 쌍**을 선택해 병합합니다.

---

### 🧠 특징

| 항목         | 설명                                           |
| ---------- | -------------------------------------------- |
| **기준**     | 군집 내 오차 제곱합(SSE) 최소 증가                       |
| **장점**     | 덴드로그램이 **균형 잡히고 해석이 용이**한 구조가 됨              |
| **단점**     | 거리 기반보다 계산량이 많고, **군집 모양이 구형에 가까운 경우**에만 효과적 |
| **적합한 경우** | 밀도보다 분산 기반 분리가 잘 되는 경우 (ex: 고객 세분화)          |

---

### 💡 예시 비교 (Linkage 방식 간 차이)

| 연결 방식       | 설명            | 결과 경향                     |
| ----------- | ------------- | ------------------------- |
| **단일 연결**   | 가장 가까운 두 점 거리 | 뱀처럼 길게 연결 (chain effect)  |
| **완전 연결**   | 가장 먼 두 점 거리   | 뚜렷하게 분리된 군집               |
| **평균 연결**   | 평균 거리         | 중간적인 모양                   |
| **Ward 연결** | SSE 증가 최소화    | K-Means와 유사한 결과, 균형 잡힌 트리 |

---

### 🛠️ Scikit-learn에서의 사용

```python
from sklearn.cluster import AgglomerativeClustering

model = AgglomerativeClustering(n_clusters=3, linkage='ward')
model.fit(X)
```

* `linkage='ward'`는 거리 계산으로 **유클리디안 거리만** 사용 가능합니다 (`affinity='euclidean'` 고정).

---

### ✅ 정리

* **Ward 연결법**은 **군집 간 분산의 증가를 최소화**하는 방식.
* 다른 linkage보다 **균형 잡힌 군집 구조**를 만들기 쉬움.
* K-Means처럼 **구형의 군집을 잘 나눔**, 그러나 **비정규 형태 데이터**에는 부적합할 수 있음.
